<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SyncSpeaker ‚Äî Turn Your Phones Into One Massive Speaker</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="logo">SS</div>
      <div>
        <div class="title">SyncSpeaker</div>
        <div class="subtitle">Turn your phones into one massive speaker</div>
      </div>
    </div>
    <div class="header-right">
      <button class="btn-parent-info" id="btnParentInfo" title="For parents">‚ÑπÔ∏è</button>
      <button class="btn-theme-toggle" id="btnThemeToggle" title="Change theme">üé®</button>
      <div class="pill" id="planPill">Free ¬∑ 2 phones</div>
    </div>
  </header>

  <main class="wrap">
    <!-- Landing Page -->
    <section class="landing-page" id="viewLanding">
      <div class="landing-hero">
        <div class="dj-icon">
          <svg role="img" aria-label="DJ headphones and turntable icon" width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
            <!-- Headphones -->
            <path d="M40 15 C25 15, 15 25, 15 40 L15 50 C15 52, 17 54, 19 54 L25 54 C27 54, 29 52, 29 50 L29 40 C29 38, 27 36, 25 36 L21 36 C21 28, 28 21, 40 21 C52 21, 59 28, 59 36 L55 36 C53 36, 51 38, 51 40 L51 50 C51 52, 53 54, 55 54 L61 54 C63 54, 65 52, 65 50 L65 40 C65 25, 55 15, 40 15 Z" fill="url(#headphoneGradient)" stroke="url(#neonStroke)" stroke-width="2"/>
            <!-- Turntable -->
            <circle cx="40" cy="55" r="15" fill="url(#turntableGradient)" stroke="url(#neonStroke)" stroke-width="2"/>
            <circle cx="40" cy="55" r="3" fill="#5AA9FF"/>
            <defs>
              <linearGradient id="headphoneGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#5AA9FF;stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:#8B7CFF;stop-opacity:0.8" />
              </linearGradient>
              <linearGradient id="turntableGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#8B7CFF;stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:#5AA9FF;stop-opacity:0.8" />
              </linearGradient>
              <linearGradient id="neonStroke" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#5AA9FF" />
                <stop offset="100%" style="stop-color:#8B7CFF" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <h1 class="landing-title">SyncSpeaker</h1>
        <p class="landing-subtitle">Turn your phones into one massive speaker</p>
        
        <!-- Equalizer Bars -->
        <div class="equalizer">
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
        </div>
      </div>

      <!-- What is SyncSpeaker -->
      <div class="glass-card">
        <h2>üéµ What is SyncSpeaker?</h2>
        <p>Connect multiple phones together and play music in perfect sync. Create an epic sound experience for parties, gatherings, or just hanging out with friends!</p>
        <p>Take control with DJ mode, queue your tracks, and get real-time reactions from your guests. Everything you need to be the ultimate party host.</p>
      </div>

      <!-- How it Works -->
      <div class="glass-card">
        <h2>‚ö° How it Works</h2>
        <div class="steps">
          <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>Start a Party</h3>
              <p>One person becomes the host and gets a party code</p>
            </div>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>Friends Join</h3>
              <p>Share the code with friends to connect their phones</p>
            </div>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>Play Together</h3>
              <p>Music plays in sync across all connected devices</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Key Features -->
      <div class="glass-card">
        <h2>‚ú® Key Features</h2>
        <div class="features-grid">
          <div class="feature-item">
            <div class="feature-icon">üéß</div>
            <h3>DJ Mode</h3>
            <p>Full-screen DJ interface with visualizers and controls. Take control with professional visual effects and real-time feedback.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">‚è≠Ô∏è</div>
            <h3>Up Next Queue</h3>
            <p>Queue your next track and see what's coming up. Seamless transitions keep the party flowing.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">üí¨</div>
            <h3>Guest Reactions</h3>
            <p>Friends can send reactions directly to the DJ's screen. Real-time crowd feedback at your fingertips.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">üì±</div>
            <h3>Browser-Ready</h3>
            <p>Test instantly in your browser or run with full multi-device sync. No app store required.</p>
          </div>
        </div>
      </div>

      <!-- Important Info -->
      <div class="glass-card info-card">
        <div class="info-row">
          <span class="info-icon">üì∂</span>
          <p><strong>Hotspot or Wi-Fi recommended</strong> for best connection quality</p>
        </div>
        <div class="info-row">
          <span class="info-icon">üéß</span>
          <p><strong>You provide the music:</strong> This app syncs playback. Music comes from your device (Spotify, YouTube, etc.)</p>
        </div>
      </div>

      <!-- Pricing -->
      <div class="glass-card pricing-card">
        <h2>üíé Pricing</h2>
        <div class="pricing-grid pricing-grid-three">
          <div class="pricing-option">
            <div class="pricing-badge free">Free</div>
            <h3>Free Plan</h3>
            <p class="pricing-desc">Perfect for small groups</p>
            <ul class="pricing-features">
              <li>‚úì Up to 2 phones</li>
              <li>‚úì Basic features</li>
              <li>‚Ä¢ Includes ads</li>
            </ul>
          </div>
          <div class="pricing-option party-pass-featured">
            <div class="popular-badge">Most popular</div>
            <div class="pricing-badge party-pass">Party Pass</div>
            <h3>üéâ Party Pass</h3>
            <p class="pricing-subtitle">(2-Hour Session)</p>
            <p class="pricing-price">¬£2.99</p>
            <p class="pricing-desc">Go Pro for tonight. No commitment.</p>
            <ul class="pricing-features">
              <li>‚úì No ads during playback</li>
              <li>‚úì Up to 10 phones</li>
              <li>‚úì Pro DJ mode with visualizers</li>
              <li>‚úì Guest reactions &amp; messaging</li>
              <li>‚úì Up Next queue system</li>
              <li>‚úì Priority sync stability</li>
              <li>‚úì Party-wide unlock</li>
            </ul>
            <button class="btn-party-pass" id="btnActivatePartyPassLanding">Activate Party Pass</button>
            <p class="pricing-fine-print">Single-use ¬∑ Valid for one party ¬∑ Auto-expires after 2 hours</p>
          </div>
          <div class="pricing-option">
            <div class="pricing-badge pro">Pro</div>
            <h3>Pro Monthly</h3>
            <p class="pricing-price">¬£9.99/month</p>
            <p class="pricing-desc">Cancel anytime</p>
            <ul class="pricing-features">
              <li>‚úì Up to 10 phones</li>
              <li>‚úì No ads</li>
              <li>‚úì Pro DJ mode with visualizers</li>
              <li>‚úì Guest reactions &amp; messaging</li>
              <li>‚úì Up Next queue system</li>
              <li>‚úì Priority sync stability</li>
              <li>‚úì Quality override warnings</li>
              <li>‚úì Speaker support</li>
            </ul>
            <button class="btn-pro-monthly" id="btnSubscribeMonthly">Subscribe Monthly</button>
          </div>
        </div>
      </div>

      <!-- CTA Buttons -->
      <div class="landing-cta">
        <button class="btn-landing primary-landing" id="btnLandingStart">
          üéâ Start Party
        </button>
        <button class="btn-landing secondary-landing" id="btnLandingJoin">
          üéµ Join Party
        </button>
      </div>

      <!-- Background Blobs -->
      <div class="blob blob-1"></div>
      <div class="blob blob-2"></div>
      <div class="blob blob-3"></div>
    </section>

    <section class="card hidden" id="viewHome">
      <h1>Play music together</h1>
      <p class="muted">
        Prototype to test the idea + flow. Audio sync in browsers varies by device ‚Äî focus on usability and ‚Äúwould you use this?‚Äù.
      </p>

      <!-- Mini Equalizer -->
      <div class="home-equalizer">
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
      </div>

      <div class="grid2">
        <div class="box">
          <h3>Start a party (Host)</h3>
          <label class="lbl">Your nickname (optional)</label>
          <input id="hostName" class="input" placeholder="Optional - Leave blank for 'Guest 1'" />
          
          <!-- Music from Phone Section -->
          <div class="music-section">
            <h4 class="music-section-title">üéµ Music (from your phone)</h4>
            <div class="music-controls">
              <input type="file" id="musicFileInput" accept="audio/*" style="display: none;" />
              <button type="button" class="btn secondary" id="btnChooseMusic">Choose music file</button>
              <button type="button" class="btn secondary hidden" id="btnChangeMusic">Change file</button>
            </div>
            <div class="music-info hidden" id="musicInfo">
              <div class="music-file-details">
                <span class="music-filename" id="musicFilename"></span>
                <span class="music-filesize" id="musicFilesize"></span>
                <span class="pill-enhanced music-status-ready" id="musicStatusReady">‚úì Ready</span>
              </div>
            </div>
            <div class="tiny muted music-helper">
              Pick any audio file from your phone (MP3, WAV, M4A, etc). We don't provide music.
            </div>
            <div class="music-warning hidden" id="musicWarning"></div>
            
            <!-- Track URL for Multi-Device Sync -->
            <div class="track-url-section" style="margin-top: 16px; padding: 12px; background: rgba(90, 169, 255, 0.1); border-radius: 8px; border: 1px solid rgba(90, 169, 255, 0.2);">
              <h5 style="margin: 0 0 8px 0; font-size: 14px; color: rgba(255, 255, 255, 0.9);">üåê Multi-Device Audio Sync (Optional)</h5>
              <div class="tiny muted" style="margin-bottom: 8px;">
                For guests to hear audio, provide a public HTTPS URL to your track:
              </div>
              <input type="text" id="trackUrlInput" class="input" placeholder="https://example.com/track.mp3" style="font-size: 13px;" />
              <div class="tiny muted" style="margin-top: 6px; font-style: italic; color: rgba(255, 255, 255, 0.6);">
                üí° Without a URL, guests see track info but won't hear audio. Use direct MP3/M4A links with CORS enabled (e.g., Dropbox public links, your server, or free audio hosting).
              </div>
            </div>
          </div>

          <button type="button" class="btn primary" id="btnCreate">Start party</button>
          <div class="party-status hidden" id="partyStatus">
            <div class="status-message" id="createStatusMessage">Waiting...</div>
            <div class="debug-info tiny muted" id="createDebugInfo"></div>
          </div>
          <div class="tiny muted">
            Users are responsible for music source. This app does not provide music.
          </div>
        </div>

        <div class="box">
          <h3>Join a party (Friend)</h3>
          <label class="lbl">Party code</label>
          <input id="joinCode" class="input" placeholder="ABC123" />
          <label class="lbl">Your nickname (optional)</label>
          <input id="guestName" class="input" placeholder="Optional - Leave blank for 'Guest 2'" />
          <button class="btn" id="btnJoin">Join party</button>
          <div class="party-status hidden" id="joinStatus">
            <div class="status-message" id="joinStatusMessage">Waiting...</div>
            <div class="debug-info tiny muted" id="joinDebugInfo"></div>
          </div>
          <div class="tiny muted">Tip: open this on another phone on the same Wi‚ÄëFi.</div>
        </div>
      </div>

      <div class="line"></div>

      <div class="row">
        <label class="check">
          <input type="checkbox" id="togglePro" />
          <span><b>Support mode (Pro)</b> (party-wide unlock)</span>
        </label>
        <span class="tiny muted">Testing mode: simulates Pro subscription.</span>
      </div>
    </section>

    <section class="card hidden" id="viewParty">
      <div class="row space">
        <div>
          <h2 id="partyTitle">Party</h2>
          <div class="muted tiny" id="partyMeta"></div>
        </div>
        <button class="btn danger" id="btnLeave">Leave</button>
      </div>

      <!-- OFFLINE MODE WARNING BANNER -->
      <div class="offline-warning" id="offlineWarning" style="display:none;">
        <div class="warning-icon">‚ö†Ô∏è</div>
        <div class="warning-content">
          <strong>PROTOTYPE MODE - Single Device Only</strong>
          <p>Multi-device sync not available in this prototype. Party codes shown for UI testing only. For real multi-device testing, server-side implementation required.</p>
        </div>
      </div>

      <!-- Party Pass Status/Upgrade Banner -->
      <div class="party-pass-banner hidden" id="partyPassBanner">
        <div class="party-pass-status hidden" id="partyPassActive">
          <div class="party-pass-icon">üéâ</div>
          <div class="party-pass-info">
            <div class="party-pass-title" id="partyPassTitle">Party Pass Active</div>
            <div class="party-pass-timer" id="partyPassTimer">5h 42m remaining</div>
            <div class="party-pass-desc hidden" id="partyPassDesc">Pro features unlocked for this party</div>
          </div>
        </div>
        <div class="party-pass-upgrade hidden" id="partyPassUpgrade">
          <div class="party-pass-upgrade-content">
            <div class="party-pass-upgrade-title">üéâ Upgrade this party ‚Äî ¬£2.99 ¬∑ 2 hours</div>
            <p class="party-pass-upgrade-tagline">Go Pro for tonight. No commitment.</p>
            <button class="btn-party-pass" id="btnActivatePartyPass">Activate Party Pass</button>
          </div>
        </div>
      </div>

      <!-- Crowd Energy Meter (Host Only) -->
      <div class="crowd-energy-card hidden" id="crowdEnergyCard">
        <div class="crowd-energy-header">
          <h3>üî• Crowd Energy</h3>
          <div class="crowd-energy-value" id="crowdEnergyValue">0</div>
        </div>
        <div class="crowd-energy-meter">
          <div class="crowd-energy-fill" id="crowdEnergyFill"></div>
          <div class="crowd-energy-peak" id="crowdEnergyPeakIndicator"></div>
        </div>
        <div class="crowd-energy-labels">
          <span class="tiny muted">Reactions boost energy</span>
          <span class="tiny muted">Peak: <span id="crowdEnergyPeakValue">0</span></span>
        </div>
      </div>

      <!-- DJ Moment Buttons (Host Only) -->
      <div class="dj-moments-card hidden" id="djMomentsCard">
        <h3>‚ö° DJ Moments</h3>
        <div class="dj-moments-grid">
          <button class="btn-dj-moment" id="btnMomentDrop" data-moment="DROP">
            <span class="moment-icon">üí•</span>
            <span class="moment-label">DROP</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentBuild" data-moment="BUILD">
            <span class="moment-icon">üìà</span>
            <span class="moment-label">BUILD</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentBreak" data-moment="BREAK">
            <span class="moment-icon">‚è∏Ô∏è</span>
            <span class="moment-label">BREAK</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentHandsUp" data-moment="HANDS_UP">
            <span class="moment-icon">üôå</span>
            <span class="moment-label">HANDS UP</span>
          </button>
        </div>
        <div class="current-moment hidden" id="currentMomentDisplay">
          <span class="current-moment-label">Current:</span>
          <span class="current-moment-value" id="currentMomentValue">DROP</span>
        </div>
      </div>

      <div class="grid3">
        <div class="box">
          <div class="row space">
            <div>
              <div class="lbl">Party code</div>
              <div class="code" id="partyCode">------</div>
            </div>
            <button class="btn" id="btnCopy">Copy</button>
          </div>
          <div class="tiny muted">Share code with friends.</div>
          <div class="party-info-footer">
            <div class="tiny muted" id="partyGuestCount">Waiting for guests...</div>
            <div class="tiny muted" id="partyTimeRemaining"></div>
          </div>
        </div>

        <div class="box">
          <div class="row space">
            <div>
              <div class="lbl">Connection strength</div>
              <div class="row">
                <span class="badge" id="qualityTier">Good</span>
                <span class="tiny muted" id="qualityHint">Minor drift possible</span>
              </div>
            </div>
            <div class="right tiny muted"><span id="qualityScore">80</span>/100</div>
          </div>
          <div class="bar"><div class="fill" id="qualityFill" style="width:80%"></div></div>
          <div class="tiny muted" id="limitsLine">Recommended: 4 ¬∑ Hard cap: 8</div>
        </div>

        <div class="box">
          <div class="lbl">Playback</div>
          
          <!-- Audio Player -->
          <audio id="hostAudioPlayer" preload="auto" controls></audio>
          
          <!-- Status Area -->
          <div class="playback-status" id="playbackStatus">
            <span class="status-label">Status:</span>
            <span class="status-message" id="statusMessage">No music loaded</span>
          </div>
          
          <div class="row gap">
            <button class="btn primary" id="btnPlay">Play</button>
            <button class="btn" id="btnPause">Pause</button>
            <button class="btn" id="btnAd">Show ad (Free)</button>
          </div>
          <button class="btn secondary hidden" id="btnBackToDj">üéß Back to DJ View</button>
          <div class="tiny muted" id="adLine">Ads can pause music for free users.</div>
        </div>
      </div>

      <div class="line"></div>

      <!-- DJ Controls Card -->
      <div class="box" id="djControlsCard">
        <h3>DJ Controls</h3>
        
        <!-- Host Gift Party Pass (Host Only) -->
        <div class="host-gift-section hidden" id="hostGiftSection">
          <div class="host-gift-header">
            <span class="gift-icon">üéÅ</span>
            <span class="gift-label">Gift Party Pass to Everyone</span>
          </div>
          <button class="btn-gift-party-pass" id="btnGiftPartyPass">
            üéâ Unlock Party for Everyone (¬£2.99)
          </button>
          <div class="tiny muted">One-time purchase unlocks Pro features for all guests in this party</div>
        </div>

        <div class="lbl">Chat Mode</div>
        <div class="chat-mode-selector">
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="OPEN" id="chatModeOpen" checked />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">üí¨</span>
              <span class="chat-mode-text">OPEN</span>
            </span>
          </label>
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="EMOJI_ONLY" id="chatModeEmojiOnly" />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">üòÄ</span>
              <span class="chat-mode-text">EMOJI ONLY</span>
            </span>
          </label>
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="LOCKED" id="chatModeLocked" />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">üîí</span>
              <span class="chat-mode-text">LOCKED</span>
            </span>
          </label>
        </div>
        <div class="tiny muted">Control guest messaging permissions</div>
      </div>

      <div class="line"></div>

      <div class="row space">
        <h3>Friends connected</h3>
        <div class="row gap">
          <button class="btn" id="btnAddPhone">Add another phone</button>
          <button class="btn" id="btnSpeaker">Use a speaker</button>
        </div>
      </div>

      <div id="members"></div>

      <div class="tiny muted" style="margin-top:10px">
        Browser prototype ‚Äî next step is the real Android app for proper sync.
      </div>
    </section>

    <!-- DJ Screen Overlay (Host Only - Shows when playing) -->
    <div class="dj-screen-overlay hidden" id="djScreenOverlay">
      <div class="dj-screen-header">
        <div class="dj-screen-title">
          <span class="dj-icon-small">üéß</span>
          <span>DJ MODE</span>
        </div>
        <button class="btn-close-dj" id="btnCloseDj">‚úï Close DJ View</button>
      </div>

      <!-- DJ Main Visual Area -->
      <div class="dj-main-visual">
        <div class="dj-equalizer-large" id="djEqualizerLarge">
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
        </div>
        
        <!-- Now Playing Display -->
        <div class="dj-now-playing">
          <div class="dj-now-playing-label">NOW PLAYING</div>
          <div class="dj-now-playing-track" id="djNowPlayingTrack">No Track</div>
        </div>
        
        <!-- Up Next Display -->
        <div class="dj-up-next hidden" id="djUpNext">
          <div class="dj-up-next-label">‚è≠ UP NEXT</div>
          <div class="dj-up-next-track" id="djUpNextTrack">No track queued</div>
        </div>
      </div>

      <!-- Guest Messages Area -->
      <div class="dj-messages-area">
        <div class="dj-messages-header">
          <span class="dj-messages-icon">üí¨</span>
          <span>GUEST REACTIONS</span>
        </div>
        <div class="dj-messages-container" id="djMessagesContainer">
          <div class="dj-no-messages" id="djNoMessages">
            Waiting for guest reactions...
          </div>
        </div>
      </div>

      <!-- Crowd Energy in DJ View -->
      <div class="dj-crowd-energy">
        <div class="dj-crowd-energy-header">
          <h3>üî• CROWD ENERGY</h3>
          <div class="dj-crowd-energy-value" id="djCrowdEnergyValue">0</div>
        </div>
        <div class="dj-crowd-energy-meter">
          <div class="dj-crowd-energy-fill" id="djCrowdEnergyFill"></div>
          <div class="dj-crowd-energy-peak" id="djCrowdEnergyPeakIndicator"></div>
        </div>
        <div class="dj-crowd-energy-labels">
          <span class="tiny muted">Reactions boost energy</span>
          <span class="tiny muted">Peak: <span id="djCrowdEnergyPeakValue">0</span></span>
        </div>
      </div>

      <!-- DJ Moments in DJ View -->
      <div class="dj-moments-section">
        <h3>‚ö° DJ MOMENTS</h3>
        <div class="dj-moments-grid-view">
          <button class="btn-dj-moment-view" id="btnDjMomentDrop" data-moment="DROP">
            <span class="moment-icon">üí•</span>
            <span class="moment-label">DROP</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentBuild" data-moment="BUILD">
            <span class="moment-icon">üìà</span>
            <span class="moment-label">BUILD</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentBreak" data-moment="BREAK">
            <span class="moment-icon">‚è∏Ô∏è</span>
            <span class="moment-label">BREAK</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentHandsUp" data-moment="HANDS_UP">
            <span class="moment-icon">üôå</span>
            <span class="moment-label">HANDS UP</span>
          </button>
        </div>
        <div class="dj-current-moment hidden" id="djCurrentMomentDisplay">
          <span class="current-moment-label">Current:</span>
          <span class="current-moment-value" id="djCurrentMomentValue">DROP</span>
        </div>
      </div>

      <!-- DJ Controls -->
      <div class="dj-controls">
        <button class="btn-dj-control" id="btnDjPlay">
          <span class="dj-control-icon">‚ñ∂Ô∏è</span>
          <span>PLAY</span>
        </button>
        <button class="btn-dj-control" id="btnDjPause">
          <span class="dj-control-icon">‚è∏Ô∏è</span>
          <span>PAUSE</span>
        </button>
        <button class="btn-dj-control secondary" id="btnDjNext">
          <span class="dj-control-icon">‚è≠Ô∏è</span>
          <span>NEXT</span>
        </button>
      </div>

      <!-- Queue Next Track -->
      <div class="dj-queue-section">
        <input type="file" id="djQueueFileInput" accept="audio/*" style="display: none;" />
        <button class="btn-dj-queue" id="btnDjQueueTrack">
          <span class="dj-queue-icon">üìÅ</span>
          <span>QUEUE NEXT TRACK</span>
        </button>
      </div>

      <!-- Party Info -->
      <div class="dj-party-info">
        <div class="dj-party-code">
          <span class="dj-info-label">PARTY CODE:</span>
          <span class="dj-info-value" id="djPartyCode">------</span>
        </div>
        <div class="dj-party-guests">
          <span class="dj-info-label">GUESTS:</span>
          <span class="dj-info-value" id="djGuestCount">0</span>
        </div>
      </div>

      <!-- Flash Overlay for Messages -->
      <div class="dj-flash-overlay" id="djFlashOverlay"></div>
    </div>

    <!-- Guest Party View -->
    <section class="card hidden" id="viewGuest">
      <div class="row space">
        <div>
          <h2>üéµ Guest Party</h2>
          <div class="muted tiny" id="guestMeta">Connected to party</div>
        </div>
        <button class="btn danger" id="btnGuestLeave">Leave Party</button>
      </div>

      <!-- Party Code and Connection Status -->
      <div class="guest-header">
        <div class="glass-card">
          <div class="row space">
            <div>
              <div class="lbl">Party Code</div>
              <div class="code" id="guestPartyCode">------</div>
            </div>
            <div class="guest-connection-status">
              <div class="lbl">Status</div>
              <span class="badge" id="guestConnectionStatus">Connecting...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Party Status Badge -->
      <div class="guest-party-status">
        <div class="party-status-badge" id="guestPartyStatusBadge">
          <span class="party-status-icon">‚ú®</span>
          <span class="party-status-text" id="guestPartyStatusText">Free Plan</span>
          <span class="party-status-timer hidden" id="guestPartyPassTimer"></span>
        </div>
      </div>

      <!-- Party Info: Guest Count and Time Remaining -->
      <div class="glass-card guest-party-info">
        <div class="row space">
          <div>
            <div class="lbl">Guests</div>
            <div class="party-info-value" id="guestPartyGuestCount">0 guests</div>
          </div>
          <div>
            <div class="lbl">Time Left</div>
            <div class="party-info-value" id="guestTimeRemaining">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Now Playing Section -->
      <div class="glass-card guest-now-playing">
        <h3 class="section-title">üéµ Now Playing</h3>
        <div class="now-playing-content">
          <div class="track-info">
            <div class="track-filename" id="guestNowPlayingFilename">No track selected</div>
            <div class="playback-state-badge">
              <span class="playback-state-icon" id="guestPlaybackStateIcon">‚è∏</span>
              <span class="playback-state-text" id="guestPlaybackStateText">Waiting</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Up Next Section -->
      <div class="glass-card guest-up-next hidden" id="guestUpNextSection">
        <h4 class="section-title-small">‚è≠ Up Next</h4>
        <div class="up-next-content">
          <div class="up-next-filename" id="guestUpNextFilename">No track queued</div>
          <span class="up-next-status-badge">Ready</span>
        </div>
      </div>

      <!-- DJ Visuals Area -->
      <div class="glass-card guest-dj-visuals">
        <h3 class="section-title">üéß DJ Visuals</h3>
        <div class="dj-visual-container" id="guestDjVisuals">
          <div class="equalizer guest-equalizer" id="guestEqualizer">
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
          </div>
          <div class="visual-status-text" id="guestVisualStatus">Synced visuals (prototype)</div>
        </div>
      </div>

      <!-- Guest Volume Control -->
      <div class="glass-card guest-volume">
        <h4 class="section-title-small">üîä Your Volume (Local)</h4>
        <div class="volume-control">
          <input type="range" min="0" max="100" value="80" class="volume-slider" id="guestVolumeSlider" />
          <span class="volume-value" id="guestVolumeValue">80%</span>
        </div>
        <div class="tiny muted">Adjust volume on your device only</div>
      </div>

      <!-- Guest Messages to Host -->
      <div class="glass-card guest-messages">
        <div class="guest-messages-header">
          <h4 class="section-title-small">üí¨ Send Message to DJ</h4>
          <div class="guest-chat-mode-badge" id="guestChatModeBadge">
            <span class="chat-mode-status-icon" id="guestChatModeIcon">üí¨</span>
            <span class="chat-mode-status-text" id="guestChatModeText">Chat: OPEN</span>
          </div>
        </div>
        
        <!-- Emoji Reactions (always visible) -->
        <div class="guest-emoji-reactions" id="guestEmojiReactions">
          <button class="btn-emoji-reaction" id="btnEmojiHeart" data-emoji="‚ù§Ô∏è" data-message="‚ù§Ô∏è">
            ‚ù§Ô∏è
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiLove" data-emoji="üòç" data-message="üòç">
            üòç
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiFire" data-emoji="üî•" data-message="üî•">
            üî•
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiParty" data-emoji="üéâ" data-message="üéâ">
            üéâ
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiDance" data-emoji="üíÉ" data-message="üíÉ">
            üíÉ
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiThumbsUp" data-emoji="üëç" data-message="üëç">
            üëç
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiStar" data-emoji="‚≠ê" data-message="‚≠ê">
            ‚≠ê
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiLightning" data-emoji="‚ö°" data-message="‚ö°">
            ‚ö°
          </button>
        </div>
        
        <!-- Text Messages (shown when not emoji-only or locked) -->
        <div class="guest-message-buttons" id="guestTextMessages">
          <button class="btn-guest-message" id="btnMessageTune" data-message="TUUUUNE!!!">
            üî• TUUUUNE!!!
          </button>
          <button class="btn-guest-message" id="btnMessageTuneUp" data-message="Tune it up!!">
            üéöÔ∏è Tune it up!!
          </button>
          <button class="btn-guest-message" id="btnMessageNext" data-message="Next!">
            ‚è≠Ô∏è Next!
          </button>
        </div>
        <div class="tiny muted">Send reactions to the host's DJ screen</div>
      </div>

      <div class="tiny muted" style="margin-top:20px; text-align: center;">
        Playback controlled by host ¬∑ Browser prototype
      </div>
    </section>
  
<!-- Debug Panel (Prototype Only) -->
<div class="debug-panel" id="debugPanel" aria-hidden="true">
  <h4 class="debug-title">Debug Panel (Prototype)</h4>
  <div class="debug-row">
    <span class="debug-label">App Version:</span>
    <span class="debug-value" id="debugAppVersion">Loading...</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Role:</span>
    <span class="debug-value" id="debugRole">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Party Code:</span>
    <span class="debug-value" id="debugPartyCode">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Connected:</span>
    <span class="debug-value" id="debugConnected">false</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Now Playing:</span>
    <span class="debug-value" id="debugNowPlaying">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Up Next:</span>
    <span class="debug-value" id="debugUpNext">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Playback State:</span>
    <span class="debug-value" id="debugPlaybackState">STOPPED</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last Host Event:</span>
    <span class="debug-value" id="debugLastHostEvent">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Visual Mode:</span>
    <span class="debug-value" id="debugVisualMode">idle</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last endpoint:</span>
    <span class="debug-value" id="debugEndpoint">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last error:</span>
    <span class="debug-value" id="debugError">None</span>
  </div>
</div>

<!-- Promo Code -->
<button class="btn secondary" id="promoBtn">Have a promo code?</button>

<div class="modal hidden" id="promoModal">
  <div class="modal-card">
    <h3>Enter promo code</h3>
    <input id="promoInput" placeholder="Promo code" />
    <button class="btn primary" id="promoApply">Unlock this party</button>
    <p class="hint">Promo codes unlock Pro for one party only.</p>
    <button class="btn link" id="promoClose">Cancel</button>
  </div>
</div>

</main>

  <div class="modal hidden" id="modalPaywall">
    <div class="modalCard">
      <h3>Support SyncSpeaker</h3>
      <p class="muted">Support removes ads, allows up to 10 phones, and lets you add more phones when you choose.</p>
      <ul class="list">
        <li>No ads</li>
        <li>Up to 10 phones</li>
        <li>Connection strength override warning + accept</li>
        <li>Speaker support</li>
      </ul>
      <div class="row gap">
        <button class="btn primary" id="btnProYes">Support mode (Pro)</button>
        <button class="btn" id="btnProNo">Not now</button>
      </div>
      <div class="tiny muted">Subscription only. Cancel anytime.</div>
    </div>
  </div>

  <div class="modal hidden" id="modalWarn">
    <div class="modalCard">
      <h3>Heads up</h3>
      <p class="muted" id="warnText"></p>
      <div class="row gap">
        <button class="btn" id="btnWarnCancel">Cancel</button>
        <button class="btn primary" id="btnWarnAnyway">Add anyway</button>
      </div>
      <div class="tiny muted">This option is for supporters.</div>
    </div>
  </div>

  <div class="modal hidden" id="modalSpeaker">
    <div class="modalCard">
      <h3>Connect to a speaker</h3>
      <p class="muted">
        Connect a Bluetooth or AUX speaker to the host phone for louder sound. (Real app will handle delay better.)
      </p>
      <div class="row gap">
        <button class="btn primary" id="btnSpeakerOk">Got it</button>
      </div>
      <div class="tiny muted">Speaker support is for supporters.</div>
    </div>
  </div>

  <div class="toast hidden" id="toast"></div>

  <!-- Party End Recap Modal -->
  <div class="modal hidden" id="modalPartyRecap">
    <div class="modal-card party-recap-card">
      <div class="recap-header">
        <h2>üéâ Party Recap</h2>
        <p class="muted">Thanks for using SyncSpeaker!</p>
      </div>
      <div class="recap-stats">
        <div class="recap-stat">
          <div class="recap-stat-icon">‚è±Ô∏è</div>
          <div class="recap-stat-value" id="recapDuration">0 min</div>
          <div class="recap-stat-label">Party Duration</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">üéµ</div>
          <div class="recap-stat-value" id="recapTracks">0</div>
          <div class="recap-stat-label">Tracks Played</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">üî•</div>
          <div class="recap-stat-value" id="recapPeakEnergy">0</div>
          <div class="recap-stat-label">Peak Energy</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">üí¨</div>
          <div class="recap-stat-value" id="recapReactions">0</div>
          <div class="recap-stat-label">Total Reactions</div>
        </div>
      </div>
      <div class="recap-top-emojis" id="recapTopEmojis">
        <h4>Top Reactions</h4>
        <div class="top-emojis-list" id="topEmojisList">
          <span class="muted tiny">No reactions yet</span>
        </div>
      </div>
      <button class="btn primary" id="btnCloseRecap">Close</button>
    </div>
  </div>

  <!-- Debug Panel (floating overlay) -->
  <div class="debug-panel hidden" id="debugPanel">
    <div class="debug-panel-header">
      <h4>üõ†Ô∏è Debug Info</h4>
      <button class="debug-panel-close" id="btnCloseDebug">‚úï</button>
    </div>
    <div class="debug-panel-content">
      <div class="debug-section">
        <h5>Connection</h5>
        <div class="debug-row">
          <span class="debug-label">Mode:</span>
          <span class="debug-value" id="debugMode">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">WebSocket:</span>
          <span class="debug-value" id="debugWsStatus">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Polling:</span>
          <span class="debug-value" id="debugPollingStatus">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Party State</h5>
        <div class="debug-row">
          <span class="debug-label">Code:</span>
          <span class="debug-value" id="debugPartyCode">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Status:</span>
          <span class="debug-value" id="debugPartyStatus">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Guests:</span>
          <span class="debug-value" id="debugGuestCount">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Playback (Guest)</h5>
        <div class="debug-row">
          <span class="debug-label">Track:</span>
          <span class="debug-value" id="debugTrackName">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Audio Ready:</span>
          <span class="debug-value" id="debugAudioReady">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Last Event:</span>
          <span class="debug-value" id="debugLastEvent">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Recent Logs</h5>
        <div class="debug-logs" id="debugLogs">
          <div class="debug-log muted">No logs yet...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Debug Toggle Button (floating) -->
  <button class="debug-toggle-btn" id="btnToggleDebug" title="Toggle Debug Panel">üõ†Ô∏è</button>

  <!-- Parent Info Panel -->
  <div class="modal hidden" id="modalParentInfo">
    <div class="modal-card parent-info-card">
      <h2>üë™ For Parents</h2>
      <div class="parent-info-content">
        <div class="info-section">
          <h3>What is SyncSpeaker?</h3>
          <p>SyncSpeaker is a music synchronization app that allows multiple phones to play music together in perfect sync. It's designed for parties and social gatherings.</p>
        </div>
        <div class="info-section">
          <h3>üîí Safety Features</h3>
          <ul>
            <li><strong>No Music Included:</strong> Users provide their own music files</li>
            <li><strong>Local Network:</strong> Works best on home Wi-Fi or hotspots</li>
            <li><strong>Host Controls:</strong> Party host controls playback and can moderate chat</li>
            <li><strong>Anonymous by Default:</strong> Guests appear as "Guest 1", "Guest 2" etc.</li>
          </ul>
        </div>
        <div class="info-section">
          <h3>üí° How It Works</h3>
          <ol>
            <li>One person starts a party and gets a code</li>
            <li>Friends join using the code on their phones</li>
            <li>Music plays in sync across all devices</li>
            <li>Host controls playback and permissions</li>
          </ol>
        </div>
        <div class="info-section">
          <h3>üí∞ Pricing</h3>
          <ul>
            <li><strong>Free Plan:</strong> Up to 2 phones, includes ads</li>
            <li><strong>Party Pass (¬£2.99):</strong> One-time unlock for one party (2-Hour Session)</li>
            <li><strong>Pro Monthly (¬£9.99):</strong> Unlimited use, up to 10 phones</li>
          </ul>
        </div>
        <div class="info-section">
          <h3>‚ö†Ô∏è Important Notes</h3>
          <ul>
            <li>This is a browser prototype for testing purposes</li>
            <li>Users are responsible for their music source</li>
            <li>Best experience with same Wi-Fi network</li>
            <li>Host can control chat permissions (Open/Emoji Only/Locked)</li>
          </ul>
        </div>
      </div>
      <button class="btn primary" id="btnCloseParentInfo">Close</button>
    </div>
  </div>

  <!-- DJ Messages Container (global overlay) -->
  <div id="djMessagesContainer"></div>

  <script src="app.js"></script>
</body>
</html>
