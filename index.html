<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SyncSpeaker â€” Turn Your Phones Into One Massive Speaker</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="logo">SS</div>
      <div>
        <div class="title">SyncSpeaker</div>
        <div class="subtitle">Turn your phones into one big speaker.</div>
      </div>
    </div>
    <div class="header-right">
      <span id="connectionIndicator">â— Connected</span>
      <button class="btn-parent-info" id="btnParentInfo" title="For parents">â„¹ï¸</button>
      <button class="btn-theme-toggle" id="btnThemeToggle" title="Change theme">ğŸ¨</button>
      <button class="btn-upgrade" id="btnUpgradeHub" title="Upgrade">â­</button>
      <button class="btn-account" id="btnAccount" title="Account">ğŸ‘¤</button>
      <div class="pill" id="planPill">Free Â· 2 phones</div>
    </div>
  </header>

  <main class="wrap">
    <!-- Landing Page -->
    <section class="landing-page" id="viewLanding">
      <div class="landing-hero">
        <div class="dj-icon">
          <svg role="img" aria-label="DJ headphones and turntable icon" width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
            <!-- Headphones -->
            <path d="M40 15 C25 15, 15 25, 15 40 L15 50 C15 52, 17 54, 19 54 L25 54 C27 54, 29 52, 29 50 L29 40 C29 38, 27 36, 25 36 L21 36 C21 28, 28 21, 40 21 C52 21, 59 28, 59 36 L55 36 C53 36, 51 38, 51 40 L51 50 C51 52, 53 54, 55 54 L61 54 C63 54, 65 52, 65 50 L65 40 C65 25, 55 15, 40 15 Z" fill="url(#headphoneGradient)" stroke="url(#neonStroke)" stroke-width="2"/>
            <!-- Turntable -->
            <circle cx="40" cy="55" r="15" fill="url(#turntableGradient)" stroke="url(#neonStroke)" stroke-width="2"/>
            <circle cx="40" cy="55" r="3" fill="#5AA9FF"/>
            <defs>
              <linearGradient id="headphoneGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#5AA9FF;stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:#8B7CFF;stop-opacity:0.8" />
              </linearGradient>
              <linearGradient id="turntableGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#8B7CFF;stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:#5AA9FF;stop-opacity:0.8" />
              </linearGradient>
              <linearGradient id="neonStroke" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#5AA9FF" />
                <stop offset="100%" style="stop-color:#8B7CFF" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <h1 class="landing-title">SyncSpeaker</h1>
        <p class="landing-subtitle">Turn your phones into one big speaker.</p>
        
        <!-- Equalizer Bars -->
        <div class="equalizer">
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
          <div class="eq-bar"></div>
        </div>
      </div>

      <!-- What is SyncSpeaker -->
      <div class="glass-card">
        <h2>ğŸµ What is SyncSpeaker?</h2>
        <p>Connect multiple phones together and play music in perfect sync. Create an epic sound experience for parties, gatherings, or just hanging out with friends!</p>
        <p>Take control with DJ mode, queue your tracks, and get real-time reactions from your guests. Everything you need to be the ultimate party host.</p>
      </div>

      <!-- How it Works -->
      <div class="glass-card">
        <h2>âš¡ How it Works</h2>
        <div class="steps">
          <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>Start a Party</h3>
              <p>One person becomes the host and gets a party code</p>
            </div>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>Friends Join</h3>
              <p>Share the code with friends to connect their phones</p>
            </div>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>Play Together</h3>
              <p>Music plays in sync across all connected devices</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Key Features -->
      <div class="glass-card">
        <h2>âœ¨ Key Features</h2>
        <div class="features-grid">
          <div class="feature-item">
            <div class="feature-icon">ğŸ§</div>
            <h3>DJ Mode</h3>
            <p>Full-screen DJ interface with visualizers and controls. Take control with professional visual effects and real-time feedback.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">â­ï¸</div>
            <h3>Up Next Queue</h3>
            <p>Queue your next track and see what's coming up. Seamless transitions keep the party flowing.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">ğŸ’¬</div>
            <h3>Guest Reactions</h3>
            <p>Friends can send reactions directly to the DJ's screen. Real-time crowd feedback at your fingertips.</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">ğŸ“±</div>
            <h3>Browser-Ready</h3>
            <p>Test instantly in your browser or run with full multi-device sync. No app store required.</p>
          </div>
        </div>
      </div>

      <!-- Important Info -->
      <div class="glass-card info-card">
        <div class="info-row">
          <span class="info-icon">ğŸ“¶</span>
          <p><strong>Hotspot or Wi-Fi recommended</strong> for best connection quality</p>
        </div>
        <div class="info-row">
          <span class="info-icon">ğŸ§</span>
          <p><strong>You provide the music:</strong> This app syncs playback. Music comes from your device (Spotify, YouTube, etc.)</p>
        </div>
      </div>

      <!-- Pricing -->
      <div class="glass-card pricing-card">
        <h2>ğŸ’ Pricing</h2>
        <div class="pricing-grid pricing-grid-three">
          <div class="pricing-option">
            <div class="pricing-badge free">Free</div>
            <h3>Free Plan</h3>
            <p class="pricing-desc">Connect 2 phones with unlimited time â€“ totally free.</p>
            <ul class="pricing-features">
              <li>âœ“ 2 phones only</li>
              <li>âœ“ <strong>Unlimited time</strong></li>
              <li>âœ“ Emoji reactions only</li>
              <li>âœ“ No DJ profile</li>
              <li>âœ“ No add-ons</li>
              <li>âœ“ No custom messages</li>
            </ul>
          </div>
          <div class="pricing-option party-pass-featured">
            <div class="popular-badge">Most popular</div>
            <div class="pricing-badge party-pass">Party Pass</div>
            <h3>ğŸ‰ Party Pass</h3>
            <p class="pricing-price">Â£2.99</p>
            <p class="pricing-desc">Perfect for small parties and hangouts.</p>
            <p class="pricing-subtitle">Up to 4 phones â€“ 2 hours â€“ preset messages.</p>
            <ul class="pricing-features">
              <li>âœ“ Up to <strong>4 phones</strong></li>
              <li>âœ“ <strong>2 hours</strong></li>
              <li>âœ“ Preset messages</li>
              <li>âœ“ DJ profile active</li>
              <li>âœ“ Add-ons available</li>
            </ul>
            <button class="btn-party-pass" id="btnActivatePartyPassLanding">Activate Party Pass</button>
            <p class="pricing-fine-print">Single-use Â· Valid for one party Â· Auto-expires after 2 hours</p>
          </div>
          <div class="pricing-option">
            <div class="pricing-badge pro">Pro</div>
            <h3>Pro Monthly</h3>
            <p class="pricing-price">Â£9.99/month</p>
            <p class="pricing-desc">Turn any room into a real DJ experience.</p>
            <p class="pricing-subtitle">Up to 12 phones â€“ unlimited time â€“ full features.</p>
            <ul class="pricing-features">
              <li>âœ“ <strong>10â€“12 phones</strong></li>
              <li>âœ“ <strong>Unlimited time</strong></li>
              <li>âœ“ Custom messages</li>
              <li>âœ“ Full DJ profile</li>
              <li>âœ“ Rankings</li>
              <li>âœ“ All add-ons</li>
            </ul>
            <button class="btn-pro-monthly" id="btnSubscribeMonthly">Subscribe Monthly</button>
          </div>
        </div>
      </div>

      <!-- BOOST YOUR PARTY ğŸš€ Add-ons Section -->
      <div class="glass-card boosts-card">
        <h2>ğŸš€ BOOST YOUR PARTY</h2>
        <p class="boosts-subtitle">Boost your party on the fly!</p>
        <div class="boosts-grid">
          
          <!-- Add-on 1: Extra Phones -->
          <div class="boost-item" id="boostExtraPhones">
            <div class="boost-status" id="boostExtraPhonesStatus">AVAILABLE</div>
            <div class="boost-icon">ğŸ“±ğŸ”Š</div>
            <h3 class="boost-title">Invite More Friends</h3>
            <p class="boost-price">Â£0.99</p>
            <p class="boost-description">Bring more crew to the party! Unlock 2 extra speakers! ğŸ”¥</p>
            <button class="btn-boost" id="btnBuyExtraPhones">Add 2 More Phones</button>
            <div class="boost-requirement hidden" id="boostExtraPhonesReq">Upgrade to Party Pass to unlock this power-up!</div>
          </div>

          <!-- Add-on 2: Extend Party Time -->
          <div class="boost-item" id="boostExtendTime">
            <div class="boost-status" id="boostExtendTimeStatus">AVAILABLE</div>
            <div class="boost-icon">â°ğŸ‰</div>
            <h3 class="boost-title">Keep The Party Alive</h3>
            <p class="boost-price">Â£1.49</p>
            <p class="boost-description">Keep the vibes going another hour! Don't let the music stop! ğŸµ</p>
            <button class="btn-boost" id="btnExtendTime">Extend Party 1 Hour</button>
            <div class="boost-requirement hidden" id="boostExtendTimeReq">Party Pass needed to extend the session!</div>
          </div>

          <!-- Add-on 3: Remove Ads -->
          <div class="boost-item" id="boostRemoveAds">
            <div class="boost-status" id="boostRemoveAdsStatus">AVAILABLE</div>
            <div class="boost-icon">ğŸ˜âœ¨</div>
            <h3 class="boost-title">Go Ad-Free Mode</h3>
            <p class="boost-price">Â£0.99</p>
            <p class="boost-description">Ad-free beats, non-stop vibes! Stay in the zone! ğŸ§</p>
            <button class="btn-boost" id="btnRemoveAds">Remove Ads</button>
            <div class="boost-requirement hidden" id="boostRemoveAdsReq">You're already ad-free â€“ nice!</div>
          </div>

          <!-- Add-on 4: Host Gifted Party Pass -->
          <div class="boost-item" id="boostGiftPartyPass">
            <div class="boost-status" id="boostGiftPartyPassStatus">AVAILABLE</div>
            <div class="boost-icon">ğŸğŸ”¥</div>
            <h3 class="boost-title">Be The Legend DJ</h3>
            <p class="boost-price">Â£2.99</p>
            <p class="boost-description">Be the legend DJ â€“ upgrade everyone instantly! Share the Pro vibes! ğŸŒŸ</p>
            <button class="btn-boost" id="btnBoostGiftPartyPass">Gift Party Pass to Guests</button>
            <div class="boost-requirement hidden" id="boostGiftPartyPassReq">Already in Party Pass mode!</div>
          </div>

        </div>
      </div>

      <!-- CTA Buttons -->
      <div class="landing-cta">
        <button class="btn-landing primary-landing" id="btnLandingStart">
          ğŸ‰ Start Party
        </button>
        <button class="btn-landing secondary-landing" id="btnLandingJoin">
          ğŸµ Join Party
        </button>
      </div>

      <!-- Background Blobs -->
      <div class="blob blob-1"></div>
      <div class="blob blob-2"></div>
      <div class="blob blob-3"></div>
    </section>

    <!-- Choose Tier Screen -->
    <section class="card hidden" id="viewChooseTier">
      <h1>Choose Your Plan</h1>
      <p class="muted">Select how you want to start your party</p>
      
      <div class="tier-selection-grid">
        <!-- FREE TIER -->
        <div class="tier-card" id="tierFree">
          <div class="tier-badge free">Free</div>
          <h2>Free Mode</h2>
          <p class="tier-tagline">Connect 2 phones with unlimited time â€“ totally free.</p>
          <ul class="tier-features">
            <li>âœ“ 2 phones only</li>
            <li>âœ“ Unlimited time</li>
            <li>âœ“ Emoji reactions only</li>
            <li>âœ— No DJ profile</li>
            <li>âœ— No add-ons</li>
            <li>âœ— No custom messages</li>
          </ul>
          <button class="btn primary" id="btnSelectFree">Create Free Party</button>
        </div>

        <!-- PARTY PASS TIER -->
        <div class="tier-card tier-featured" id="tierPartyPass">
          <div class="popular-badge">Most popular</div>
          <div class="tier-badge party-pass">Party Pass</div>
          <h2>Party Pass</h2>
          <p class="tier-price">Â£2.99</p>
          <p class="tier-tagline">Perfect for small parties and hangouts.</p>
          <p class="tier-subtitle">Up to 4 phones â€“ 2 hours â€“ preset messages.</p>
          <ul class="tier-features">
            <li>âœ“ Up to 4 phones</li>
            <li>âœ“ 2 hours</li>
            <li>âœ“ Preset messages</li>
            <li>âœ“ DJ profile active</li>
            <li>âœ“ Add-ons available</li>
          </ul>
          <button class="btn btn-party-pass" id="btnSelectPartyPass">Select Party Pass</button>
        </div>

        <!-- PRO TIER -->
        <div class="tier-card" id="tierPro">
          <div class="tier-badge pro">Pro</div>
          <h2>Pro Monthly</h2>
          <p class="tier-price">Â£9.99/month</p>
          <p class="tier-tagline">Turn any room into a real DJ experience.</p>
          <p class="tier-subtitle">Up to 12 phones â€“ unlimited time â€“ full features.</p>
          <ul class="tier-features">
            <li>âœ“ 10â€“12 phones</li>
            <li>âœ“ Unlimited time</li>
            <li>âœ“ Custom messages</li>
            <li>âœ“ Full DJ profile</li>
            <li>âœ“ Rankings</li>
            <li>âœ“ All add-ons</li>
          </ul>
          <button class="btn btn-pro-monthly" id="btnSelectPro">Pro Mode Required</button>
        </div>
      </div>

      <button class="btn secondary" id="btnBackToLanding" style="margin-top: 2rem;">â† Back</button>
    </section>

    <section class="card hidden" id="viewHome">
      <h1>Play music together</h1>
      <p class="muted">
        Prototype to test the idea + flow. Audio sync in browsers varies by device â€” focus on usability and â€œwould you use this?â€.
      </p>

      <!-- Mini Equalizer -->
      <div class="home-equalizer">
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
        <div class="home-eq-bar"></div>
      </div>

      <div class="grid2">
        <div class="box">
          <h3>Start a party (Host)</h3>
          <label class="lbl">Your DJ name (required)</label>
          <input id="hostName" class="input" placeholder="Enter your name (e.g., Alex)" required />
          
          <!-- Music from Phone Section -->
          <div class="music-section">
            <h4 class="music-section-title">ğŸµ Music (from your phone)</h4>
            <div class="music-controls">
              <input type="file" id="musicFileInput" accept="audio/*" style="display: none;" />
              <button type="button" class="btn secondary" id="btnChooseMusic">Choose music file</button>
              <button type="button" class="btn secondary hidden" id="btnChangeMusic">Change file</button>
            </div>
            <div class="music-info hidden" id="musicInfo">
              <div class="music-file-details">
                <span class="music-filename" id="musicFilename"></span>
                <span class="music-filesize" id="musicFilesize"></span>
                <span class="pill-enhanced music-status-ready" id="musicStatusReady">âœ“ Ready</span>
              </div>
            </div>
            
            <!-- Upload Status -->
            <div class="hidden" id="uploadStatus">
              <div class="upload-progress-container">
                <div class="upload-progress-bar">
                  <div class="upload-progress-fill" id="uploadProgressBar" style="width: 0%"></div>
                </div>
                <div class="upload-progress-text" id="uploadProgress">Preparing upload...</div>
              </div>
            </div>
            
            <div class="tiny muted music-helper">
              Pick any audio file from your phone (MP3, WAV, M4A, etc). We don't provide music.
            </div>
            <div class="music-warning hidden" id="musicWarning"></div>
          </div>

          <button type="button" class="btn primary" id="btnCreate">ğŸ‰ Start the party</button>
          <div class="party-status hidden" id="partyStatus">
            <div class="status-message" id="createStatusMessage">Waiting...</div>
            <div class="debug-info tiny muted" id="createDebugInfo"></div>
          </div>
          <div class="tiny muted">
            Users are responsible for music source. This app does not provide music.
          </div>
        </div>

        <div class="box">
          <h3>Join a party (Friend)</h3>
          <label class="lbl">Party code</label>
          <input id="joinCode" class="input" placeholder="ABC123" />
          <label class="lbl">Your nickname (optional)</label>
          <input id="guestName" class="input" placeholder="Optional - Leave blank for 'Guest 2'" />
          <button class="btn" id="btnJoin">ğŸµ Join the vibe</button>
          <div class="party-status hidden" id="joinStatus">
            <div class="status-message" id="joinStatusMessage">Waiting...</div>
            <div class="debug-info tiny muted" id="joinDebugInfo"></div>
          </div>
          <div class="tiny muted">Tip: open this on another phone on the same Wiâ€‘Fi.</div>
        </div>
      </div>

      <div class="line"></div>

      <div class="row">
        <label class="check">
          <input type="checkbox" id="togglePro" />
          <span><b>Support mode (Pro)</b> (party-wide unlock)</span>
        </label>
        <span class="tiny muted">Testing mode: simulates Pro subscription.</span>
      </div>
    </section>

    <section class="card hidden" id="viewParty">
      <div class="row space">
        <div>
          <h2 id="partyTitle">Party</h2>
          <div class="muted tiny" id="partyMeta"></div>
        </div>
        <button class="btn danger" id="btnLeave">Leave</button>
      </div>

      <!-- OFFLINE MODE WARNING BANNER -->
      <div class="offline-warning" id="offlineWarning" style="display:none;">
        <div class="warning-icon">âš ï¸</div>
        <div class="warning-content">
          <strong>PROTOTYPE MODE - Single Device Only</strong>
          <p>Multi-device sync not available in this prototype. Party codes shown for UI testing only. For real multi-device testing, server-side implementation required.</p>
        </div>
      </div>

      <!-- Party Pass Status/Upgrade Banner -->
      <div class="party-pass-banner hidden" id="partyPassBanner">
        <div class="party-pass-status hidden" id="partyPassActive">
          <div class="party-pass-icon">ğŸ‰</div>
          <div class="party-pass-info">
            <div class="party-pass-title" id="partyPassTitle">Party Pass Active</div>
            <div class="party-pass-timer" id="partyPassTimer">5h 42m remaining</div>
            <div class="party-pass-desc hidden" id="partyPassDesc">Pro features unlocked for this party</div>
          </div>
        </div>
        <div class="party-pass-upgrade hidden" id="partyPassUpgrade">
          <div class="party-pass-upgrade-content">
            <div class="party-pass-upgrade-title">ğŸ‰ Upgrade this party â€” Â£2.99 Â· 2 hours</div>
            <p class="party-pass-upgrade-tagline">Go Pro for tonight. No commitment.</p>
            <button class="btn-party-pass" id="btnActivatePartyPass">Activate Party Pass</button>
          </div>
        </div>
      </div>

      <!-- Crowd Energy Meter (Host Only) -->
      <div class="crowd-energy-card hidden" id="crowdEnergyCard">
        <div class="crowd-energy-header">
          <h3>ğŸ”¥ Crowd Energy</h3>
          <div class="crowd-energy-value" id="crowdEnergyValue">0</div>
        </div>
        <div class="crowd-energy-meter">
          <div class="crowd-energy-fill" id="crowdEnergyFill"></div>
          <div class="crowd-energy-peak" id="crowdEnergyPeakIndicator"></div>
        </div>
        <div class="crowd-energy-labels">
          <span class="tiny muted">Reactions boost energy</span>
          <span class="tiny muted">Peak: <span id="crowdEnergyPeakValue">0</span></span>
        </div>
      </div>

      <!-- DJ Moment Buttons (Host Only) -->
      <div class="dj-moments-card hidden" id="djMomentsCard">
        <h3>âš¡ DJ Moments</h3>
        <div class="dj-moments-grid">
          <button class="btn-dj-moment" id="btnMomentDrop" data-moment="DROP">
            <span class="moment-icon">ğŸ’¥</span>
            <span class="moment-label">DROP</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentBuild" data-moment="BUILD">
            <span class="moment-icon">ğŸ“ˆ</span>
            <span class="moment-label">BUILD</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentBreak" data-moment="BREAK">
            <span class="moment-icon">â¸ï¸</span>
            <span class="moment-label">BREAK</span>
          </button>
          <button class="btn-dj-moment" id="btnMomentHandsUp" data-moment="HANDS_UP">
            <span class="moment-icon">ğŸ™Œ</span>
            <span class="moment-label">HANDS UP</span>
          </button>
        </div>
        <div class="current-moment hidden" id="currentMomentDisplay">
          <span class="current-moment-label">Current:</span>
          <span class="current-moment-value" id="currentMomentValue">DROP</span>
        </div>
      </div>

      <div class="grid3">
        <div class="box">
          <div class="row space">
            <div>
              <div class="lbl">Party code</div>
              <div class="code" id="partyCode">------</div>
            </div>
            <div style="display: flex; gap: 8px;">
              <button class="btn" id="btnCopy">Copy</button>
              <button class="btn" id="btnShowQR" title="Show QR Code">ğŸ“±</button>
              <button class="btn" id="btnShare" title="Share">ğŸ“¤</button>
            </div>
          </div>
          <div class="tiny muted">Share code with friends.</div>
          <div class="party-info-footer">
            <div class="tiny muted" id="partyGuestCount">Waiting for guests...</div>
            <div class="tiny muted" id="partyTimeRemaining"></div>
          </div>
        </div>

        <div class="box">
          <div class="row space">
            <div>
              <div class="lbl">Connection strength</div>
              <div class="row">
                <span class="badge" id="qualityTier">Good</span>
                <span class="tiny muted" id="qualityHint">Minor drift possible</span>
              </div>
            </div>
            <div class="right tiny muted"><span id="qualityScore">80</span>/100</div>
          </div>
          <div class="bar"><div class="fill" id="qualityFill" style="width:80%"></div></div>
          <div class="tiny muted" id="limitsLine">Recommended: 4 Â· Hard cap: 8</div>
        </div>

        <div class="box">
          <div class="lbl">Playback</div>
          
          <!-- Audio Player -->
          <audio id="hostAudioPlayer" preload="auto" controls></audio>
          
          <!-- Status Area -->
          <div class="playback-status" id="playbackStatus">
            <span class="status-label">Status:</span>
            <span class="status-message" id="statusMessage">No music loaded</span>
          </div>
          
          <div class="row gap">
            <button class="btn primary" id="btnPlay">Play</button>
            <button class="btn" id="btnPause">Pause</button>
            <button class="btn" id="btnAd">Show ad (Free)</button>
          </div>
          <button class="btn secondary hidden" id="btnBackToDj">ğŸ§ Back to DJ View</button>
          <div class="tiny muted" id="adLine">Ads can pause music for free users.</div>
        </div>
      </div>

      <div class="line"></div>

      <!-- DJ Controls Card -->
      <div class="box" id="djControlsCard">
        <h3>DJ Controls</h3>
        
        <!-- Host Gift Party Pass (Host Only) -->
        <div class="host-gift-section hidden" id="hostGiftSection">
          <div class="host-gift-header">
            <span class="gift-icon">ğŸ</span>
            <span class="gift-label">Gift Party Pass to Everyone</span>
          </div>
          <button class="btn-gift-party-pass" id="btnGiftPartyPass">
            ğŸ‰ Unlock Party for Everyone (Â£2.99)
          </button>
          <div class="tiny muted">One-time purchase unlocks Pro features for all guests in this party</div>
        </div>

        <div class="lbl">Chat Mode</div>
        <div class="chat-mode-selector">
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="OPEN" id="chatModeOpen" checked />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">ğŸ’¬</span>
              <span class="chat-mode-text">OPEN</span>
            </span>
          </label>
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="EMOJI_ONLY" id="chatModeEmojiOnly" />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">ğŸ˜€</span>
              <span class="chat-mode-text">EMOJI ONLY</span>
            </span>
          </label>
          <label class="chat-mode-option">
            <input type="radio" name="chatMode" value="LOCKED" id="chatModeLocked" />
            <span class="chat-mode-label">
              <span class="chat-mode-icon">ğŸ”’</span>
              <span class="chat-mode-text">LOCKED</span>
            </span>
          </label>
        </div>
        <div class="tiny muted">Control guest messaging permissions</div>
      </div>

      <div class="line"></div>

      <div class="row space">
        <h3>Friends connected</h3>
        <div class="row gap">
          <button class="btn" id="btnAddPhone">Add another phone</button>
          <button class="btn" id="btnSpeaker">Use a speaker</button>
        </div>
      </div>

      <div id="members"></div>

      <div class="tiny muted" style="margin-top:10px">
        Browser prototype â€” next step is the real Android app for proper sync.
      </div>
    </section>

    <!-- DJ Screen Overlay (Host Only - Shows when playing) -->
    <div class="dj-screen-overlay hidden" id="djScreenOverlay">
      <div class="dj-screen-header">
        <div class="dj-screen-title">
          <span class="dj-icon-small">ğŸ§</span>
          <span>DJ MODE</span>
        </div>
        <button class="btn-close-dj" id="btnCloseDj">âœ• Close DJ View</button>
      </div>

      <!-- DJ Main Visual Area -->
      <div class="dj-main-visual">
        <div class="dj-equalizer-large" id="djEqualizerLarge">
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
          <div class="dj-eq-bar"></div>
        </div>
        
        <!-- Now Playing Display -->
        <div class="dj-now-playing">
          <div class="dj-now-playing-label">NOW PLAYING</div>
          <div class="dj-now-playing-track" id="djNowPlayingTrack">No Track</div>
        </div>
        
        <!-- Up Next Display -->
        <div class="dj-up-next hidden" id="djUpNext">
          <div class="dj-up-next-label">â­ UP NEXT</div>
          <div class="dj-up-next-track" id="djUpNextTrack">No track queued</div>
        </div>
      </div>

      <!-- Guest Messages Area -->
      <div class="dj-messages-area">
        <div class="dj-messages-header">
          <span class="dj-messages-icon">ğŸ’¬</span>
          <span>GUEST REACTIONS</span>
        </div>
        <div class="dj-messages-container" id="djMessagesContainer">
          <div class="dj-no-messages" id="djNoMessages">
            Waiting for guest reactions...
          </div>
        </div>
      </div>

      <!-- Crowd Energy in DJ View -->
      <div class="dj-crowd-energy">
        <div class="dj-crowd-energy-header">
          <h3>ğŸ”¥ CROWD ENERGY</h3>
          <div class="dj-crowd-energy-value" id="djCrowdEnergyValue">0</div>
        </div>
        <div class="dj-crowd-energy-meter">
          <div class="dj-crowd-energy-fill" id="djCrowdEnergyFill"></div>
          <div class="dj-crowd-energy-peak" id="djCrowdEnergyPeakIndicator"></div>
        </div>
        <div class="dj-crowd-energy-labels">
          <span class="tiny muted">Reactions boost energy</span>
          <span class="tiny muted">Peak: <span id="djCrowdEnergyPeakValue">0</span></span>
        </div>
      </div>

      <!-- DJ Moments in DJ View -->
      <div class="dj-moments-section">
        <h3>âš¡ DJ MOMENTS</h3>
        <div class="dj-moments-grid-view">
          <button class="btn-dj-moment-view" id="btnDjMomentDrop" data-moment="DROP">
            <span class="moment-icon">ğŸ’¥</span>
            <span class="moment-label">DROP</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentBuild" data-moment="BUILD">
            <span class="moment-icon">ğŸ“ˆ</span>
            <span class="moment-label">BUILD</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentBreak" data-moment="BREAK">
            <span class="moment-icon">â¸ï¸</span>
            <span class="moment-label">BREAK</span>
          </button>
          <button class="btn-dj-moment-view" id="btnDjMomentHandsUp" data-moment="HANDS_UP">
            <span class="moment-icon">ğŸ™Œ</span>
            <span class="moment-label">HANDS UP</span>
          </button>
        </div>
        <div class="dj-current-moment hidden" id="djCurrentMomentDisplay">
          <span class="current-moment-label">Current:</span>
          <span class="current-moment-value" id="djCurrentMomentValue">DROP</span>
        </div>
      </div>

      <!-- DJ Controls -->
      <div class="dj-controls">
        <button class="btn-dj-control" id="btnDjPlay">
          <span class="dj-control-icon">â–¶ï¸</span>
          <span>PLAY</span>
        </button>
        <button class="btn-dj-control" id="btnDjPause">
          <span class="dj-control-icon">â¸ï¸</span>
          <span>PAUSE</span>
        </button>
        <button class="btn-dj-control secondary" id="btnDjNext">
          <span class="dj-control-icon">â­ï¸</span>
          <span>NEXT</span>
        </button>
      </div>

      <!-- Queue Next Track -->
      <div class="dj-queue-section">
        <input type="file" id="djQueueFileInput" accept="audio/*" style="display: none;" />
        <button class="btn-dj-queue" id="btnDjQueueTrack">
          <span class="dj-queue-icon">ğŸ“</span>
          <span>QUEUE NEXT TRACK</span>
        </button>
      </div>

      <!-- Party Info -->
      <div class="dj-party-info">
        <div class="dj-party-code">
          <span class="dj-info-label">PARTY CODE:</span>
          <span class="dj-info-value" id="djPartyCode">------</span>
        </div>
        <div class="dj-party-guests">
          <span class="dj-info-label">GUESTS:</span>
          <span class="dj-info-value" id="djGuestCount">0</span>
        </div>
      </div>

      <!-- Flash Overlay for Messages -->
      <div class="dj-flash-overlay" id="djFlashOverlay"></div>
    </div>

    <!-- Payment Screen for Party Pass -->
    <section class="card hidden" id="viewPayment">
      <h1>Activate Party Pass</h1>
      <p class="muted">Complete your purchase to unlock Party Pass features</p>

      <div class="payment-summary glass-card">
        <h2>Order Summary</h2>
        <div class="payment-item">
          <span>Party Pass (2-Hour Session)</span>
          <span class="payment-price">Â£2.99</span>
        </div>
        <div class="payment-total">
          <strong>Total</strong>
          <strong>Â£2.99</strong>
        </div>
        
        <div class="payment-features">
          <h3>What's Included:</h3>
          <ul>
            <li>âœ“ Up to 4 phones</li>
            <li>âœ“ 2 hours of party time</li>
            <li>âœ“ Preset messages</li>
            <li>âœ“ DJ profile active</li>
            <li>âœ“ Add-ons available</li>
          </ul>
        </div>
      </div>

      <div class="payment-form glass-card">
        <h3>Payment Method</h3>
        <p class="muted tiny">This is a prototype - payment processing not implemented</p>
        
        <div class="payment-buttons">
          <button class="btn btn-party-pass" id="btnCompletePayment">Complete Purchase (Demo)</button>
          <button class="btn secondary" id="btnCancelPayment">Cancel</button>
        </div>
      </div>
    </section>

    <!-- Guest Party View -->
    <section class="card hidden" id="viewGuest">
      <div class="row space">
        <div>
          <h2>ğŸµ Guest Party</h2>
          <div class="muted tiny" id="guestMeta">Connected to party</div>
        </div>
        <button class="btn danger" id="btnGuestLeave">Leave Party</button>
      </div>

      <!-- Party Code and Connection Status -->
      <div class="guest-header">
        <div class="glass-card">
          <div class="row space">
            <div>
              <div class="lbl">Party Code</div>
              <div class="code" id="guestPartyCode">------</div>
            </div>
            <div class="guest-connection-status">
              <div class="lbl">Status</div>
              <span class="badge" id="guestConnectionStatus">Connecting...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Party Status Badge -->
      <div class="guest-party-status">
        <div class="party-status-badge" id="guestPartyStatusBadge">
          <span class="party-status-icon">âœ¨</span>
          <span class="party-status-text" id="guestPartyStatusText">Free Plan</span>
          <span class="party-status-timer hidden" id="guestPartyPassTimer"></span>
        </div>
      </div>

      <!-- Party Info: Guest Count and Time Remaining -->
      <div class="glass-card guest-party-info">
        <div class="row space">
          <div>
            <div class="lbl">Guests</div>
            <div class="party-info-value" id="guestPartyGuestCount">0 guests</div>
          </div>
          <div>
            <div class="lbl">Time Left</div>
            <div class="party-info-value" id="guestTimeRemaining">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Now Playing Section -->
      <div class="glass-card guest-now-playing">
        <h3 class="section-title">ğŸµ Now Playing</h3>
        <div class="now-playing-content">
          <div class="track-info">
            <div class="track-filename" id="guestNowPlayingFilename">No track selected</div>
            <div class="playback-state-badge">
              <span class="playback-state-icon" id="guestPlaybackStateIcon">â¸</span>
              <span class="playback-state-text" id="guestPlaybackStateText">Waiting</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Up Next Section -->
      <div class="glass-card guest-up-next hidden" id="guestUpNextSection">
        <h4 class="section-title-small">â­ Up Next</h4>
        <div class="up-next-content">
          <div class="up-next-filename" id="guestUpNextFilename">No track queued</div>
          <span class="up-next-status-badge">Ready</span>
        </div>
      </div>
      
      <!-- Queue Section -->
      <div class="glass-card guest-queue-container">
        <h4 class="guest-queue-title">ğŸ“‹ Queue</h4>
        <div id="guestQueueList">
          <div class="queue-empty">No tracks in queue</div>
        </div>
      </div>

      <!-- DJ Visuals Area -->
      <div class="glass-card guest-dj-visuals">
        <h3 class="section-title">ğŸ§ DJ Visuals</h3>
        <div class="dj-visual-container" id="guestDjVisuals">
          <div class="equalizer guest-equalizer" id="guestEqualizer">
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
            <div class="eq-bar"></div>
          </div>
          <div class="visual-status-text" id="guestVisualStatus">Synced visuals (prototype)</div>
        </div>
      </div>

      <!-- Guest Volume Control -->
      <div class="glass-card guest-volume">
        <h4 class="section-title-small">ğŸ”Š Your Volume (Local)</h4>
        <div class="volume-control">
          <input type="range" min="0" max="100" value="80" class="volume-slider" id="guestVolumeSlider" />
          <span class="volume-value" id="guestVolumeValue">80%</span>
        </div>
        <div class="tiny muted">Adjust volume on your device only</div>
      </div>

      <!-- Guest Sync Controls -->
      <div class="glass-card guest-sync-controls">
        <h4 class="section-title-small">ğŸµ Sync Controls</h4>
        
        <!-- Sync Quality Indicator -->
        <div class="sync-quality-section">
          <div class="sync-quality-header">
            <span class="sync-quality-label">Sync Quality:</span>
            <span class="sync-quality-badge" id="guestSyncQuality">Good</span>
          </div>
          <div class="sync-drift-info">
            <span class="tiny muted">Drift: <span id="guestDriftValue">0.00</span>s</span>
          </div>
        </div>

        <!-- Resync Button -->
        <button class="btn-resync" id="btnGuestResync">
          <span class="resync-icon">ğŸ”„</span>
          <span>Tap to Resync</span>
        </button>

        <!-- Report Out of Sync Button -->
        <button class="btn-report-sync secondary" id="btnReportOutOfSync">
          <span>âš ï¸ Report Out of Sync</span>
        </button>

        <div class="tiny muted">Use resync if audio feels off</div>
      </div>

      <!-- Guest Messages to Host -->
      <div class="glass-card guest-messages">
        <div class="guest-messages-header">
          <h4 class="section-title-small">ğŸ’¬ Send Message to DJ</h4>
          <div class="guest-chat-mode-badge" id="guestChatModeBadge">
            <span class="chat-mode-status-icon" id="guestChatModeIcon">ğŸ’¬</span>
            <span class="chat-mode-status-text" id="guestChatModeText">Chat: OPEN</span>
          </div>
        </div>
        
        <!-- Emoji Reactions (always visible) -->
        <div class="guest-emoji-reactions" id="guestEmojiReactions">
          <button class="btn-emoji-reaction" id="btnEmojiHeart" data-emoji="â¤ï¸" data-message="â¤ï¸">
            â¤ï¸
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiLove" data-emoji="ğŸ˜" data-message="ğŸ˜">
            ğŸ˜
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiFire" data-emoji="ğŸ”¥" data-message="ğŸ”¥">
            ğŸ”¥
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiParty" data-emoji="ğŸ‰" data-message="ğŸ‰">
            ğŸ‰
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiDance" data-emoji="ğŸ’ƒ" data-message="ğŸ’ƒ">
            ğŸ’ƒ
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiThumbsUp" data-emoji="ğŸ‘" data-message="ğŸ‘">
            ğŸ‘
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiStar" data-emoji="â­" data-message="â­">
            â­
          </button>
          <button class="btn-emoji-reaction" id="btnEmojiLightning" data-emoji="âš¡" data-message="âš¡">
            âš¡
          </button>
        </div>
        
        <!-- Text Messages (shown when not emoji-only or locked) -->
        <div class="guest-message-buttons" id="guestTextMessages">
          <button class="btn-guest-message" id="btnMessageTune" data-message="TUUUUNE!!!">
            ğŸ”¥ TUUUUNE!!!
          </button>
          <button class="btn-guest-message" id="btnMessageTuneUp" data-message="Tune it up!!">
            ğŸšï¸ Tune it up!!
          </button>
          <button class="btn-guest-message" id="btnMessageNext" data-message="Next!">
            â­ï¸ Next!
          </button>
        </div>
        <div class="tiny muted">Send reactions to the host's DJ screen</div>
      </div>

      <div class="tiny muted" style="margin-top:20px; text-align: center;">
        Playback controlled by host Â· Browser prototype
      </div>
    </section>
  
<!-- Debug Panel (Prototype Only) -->
<div class="debug-panel" id="debugPanel" aria-hidden="true">
  <h4 class="debug-title">Debug Panel (Prototype)</h4>
  <div class="debug-row">
    <span class="debug-label">App Version:</span>
    <span class="debug-value" id="debugAppVersion">Loading...</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Role:</span>
    <span class="debug-value" id="debugRole">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Party Code:</span>
    <span class="debug-value" id="debugPartyCode">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Connected:</span>
    <span class="debug-value" id="debugConnected">false</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Now Playing:</span>
    <span class="debug-value" id="debugNowPlaying">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Up Next:</span>
    <span class="debug-value" id="debugUpNext">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Playback State:</span>
    <span class="debug-value" id="debugPlaybackState">STOPPED</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last Host Event:</span>
    <span class="debug-value" id="debugLastHostEvent">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Visual Mode:</span>
    <span class="debug-value" id="debugVisualMode">idle</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last endpoint:</span>
    <span class="debug-value" id="debugEndpoint">None</span>
  </div>
  <div class="debug-row">
    <span class="debug-label">Last error:</span>
    <span class="debug-value" id="debugError">None</span>
  </div>
</div>

<!-- Promo Code -->
<button class="btn secondary" id="promoBtn">Have a promo code?</button>

<div class="modal hidden" id="promoModal">
  <div class="modal-card">
    <h3>Enter promo code</h3>
    <input id="promoInput" placeholder="Promo code" />
    <button class="btn primary" id="promoApply">Unlock this party</button>
    <p class="hint">Promo codes unlock Pro for one party only.</p>
    <button class="btn link" id="promoClose">Cancel</button>
  </div>
</div>

</main>

  <div class="modal hidden" id="modalPaywall">
    <div class="modalCard">
      <h3>Support SyncSpeaker</h3>
      <p class="muted">Support removes ads, allows up to 10 phones, and lets you add more phones when you choose.</p>
      <ul class="list">
        <li>No ads</li>
        <li>Up to 10 phones</li>
        <li>Connection strength override warning + accept</li>
        <li>Speaker support</li>
      </ul>
      <div class="row gap">
        <button class="btn primary" id="btnProYes">Support mode (Pro)</button>
        <button class="btn" id="btnProNo">Not now</button>
      </div>
      <div class="tiny muted">Subscription only. Cancel anytime.</div>
    </div>
  </div>

  <div class="modal hidden" id="modalWarn">
    <div class="modalCard">
      <h3>Heads up</h3>
      <p class="muted" id="warnText"></p>
      <div class="row gap">
        <button class="btn" id="btnWarnCancel">Cancel</button>
        <button class="btn primary" id="btnWarnAnyway">Add anyway</button>
      </div>
      <div class="tiny muted">This option is for supporters.</div>
    </div>
  </div>

  <div class="modal hidden" id="modalSpeaker">
    <div class="modalCard">
      <h3>Connect to a speaker</h3>
      <p class="muted">
        Connect a Bluetooth or AUX speaker to the host phone for louder sound. (Real app will handle delay better.)
      </p>
      <div class="row gap">
        <button class="btn primary" id="btnSpeakerOk">Got it</button>
      </div>
      <div class="tiny muted">Speaker support is for supporters.</div>
    </div>
  </div>

  <div class="modal hidden" id="modalQRCode">
    <div class="modalCard">
      <h3>ğŸ“± Join Party</h3>
      <div id="qrCodeContainer"></div>
      <button class="btn primary full-width" id="btnCloseQR">Close</button>
    </div>
  </div>

  <div class="toast hidden" id="toast"></div>

   <!-- Party End Recap Modal -->
  <div class="modal hidden" id="modalPartyRecap">
    <div class="modal-card party-recap-card">
      <div class="recap-header">
        <h2>ğŸ‰ Great set, DJ!</h2>
        <p class="muted">Thanks for using SyncSpeaker!</p>
      </div>
      <div class="recap-stats">
        <div class="recap-stat">
          <div class="recap-stat-icon">â±ï¸</div>
          <div class="recap-stat-value" id="recapDuration">0 min</div>
          <div class="recap-stat-label">Party Duration</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">ğŸµ</div>
          <div class="recap-stat-value" id="recapTracks">0</div>
          <div class="recap-stat-label">Tracks Played</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">ğŸ”¥</div>
          <div class="recap-stat-value" id="recapPeakEnergy">0</div>
          <div class="recap-stat-label">Peak Energy</div>
        </div>
        <div class="recap-stat">
          <div class="recap-stat-icon">ğŸ’¬</div>
          <div class="recap-stat-value" id="recapReactions">0</div>
          <div class="recap-stat-label">Total Reactions</div>
        </div>
      </div>
      <div class="recap-top-emojis" id="recapTopEmojis">
        <h4>Top Reactions</h4>
        <div class="top-emojis-list" id="topEmojisList">
          <span class="muted tiny">No reactions yet</span>
        </div>
      </div>
      <button class="btn primary" id="btnCloseRecap">Close</button>
    </div>
  </div>

  <!-- Debug Panel (floating overlay) -->
  <div class="debug-panel hidden" id="debugPanel">
    <div class="debug-panel-header">
      <h4>ğŸ› ï¸ Debug Info</h4>
      <button class="debug-panel-close" id="btnCloseDebug">âœ•</button>
    </div>
    <div class="debug-panel-content">
      <div class="debug-section">
        <h5>Connection</h5>
        <div class="debug-row">
          <span class="debug-label">Mode:</span>
          <span class="debug-value" id="debugMode">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">WebSocket:</span>
          <span class="debug-value" id="debugWsStatus">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Polling:</span>
          <span class="debug-value" id="debugPollingStatus">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Party State</h5>
        <div class="debug-row">
          <span class="debug-label">Code:</span>
          <span class="debug-value" id="debugPartyCode">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Status:</span>
          <span class="debug-value" id="debugPartyStatus">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Guests:</span>
          <span class="debug-value" id="debugGuestCount">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Playback (Guest)</h5>
        <div class="debug-row">
          <span class="debug-label">Track:</span>
          <span class="debug-value" id="debugTrackName">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Audio Ready:</span>
          <span class="debug-value" id="debugAudioReady">-</span>
        </div>
        <div class="debug-row">
          <span class="debug-label">Last Event:</span>
          <span class="debug-value" id="debugLastEvent">-</span>
        </div>
      </div>
      
      <div class="debug-section">
        <h5>Recent Logs</h5>
        <div class="debug-logs" id="debugLogs">
          <div class="debug-log muted">No logs yet...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Debug Toggle Button (floating) -->
  <button class="debug-toggle-btn" id="btnToggleDebug" title="Toggle Debug Panel">ğŸ› ï¸</button>

  <!-- Parent Info Panel -->
  <div class="modal hidden" id="modalParentInfo">
    <div class="modal-card parent-info-card">
      <h2>ğŸ‘ª For Parents</h2>
      <div class="parent-info-content">
        <div class="info-section">
          <h3>What is SyncSpeaker?</h3>
          <p>SyncSpeaker is a music synchronization app that allows multiple phones to play music together in perfect sync. It's designed for parties and social gatherings.</p>
        </div>
        <div class="info-section">
          <h3>ğŸ”’ Safety Features</h3>
          <ul>
            <li><strong>No Music Included:</strong> Users provide their own music files</li>
            <li><strong>Local Network:</strong> Works best on home Wi-Fi or hotspots</li>
            <li><strong>Host Controls:</strong> Party host controls playback and can moderate chat</li>
            <li><strong>Anonymous by Default:</strong> Guests appear as "Guest 1", "Guest 2" etc.</li>
          </ul>
        </div>
        <div class="info-section">
          <h3>ğŸ’¡ How It Works</h3>
          <ol>
            <li>One person starts a party and gets a code</li>
            <li>Friends join using the code on their phones</li>
            <li>Music plays in sync across all devices</li>
            <li>Host controls playback and permissions</li>
          </ol>
        </div>
        <div class="info-section">
          <h3>ğŸ’° Pricing</h3>
          <ul>
            <li><strong>Free Plan:</strong> Up to 2 phones, includes ads</li>
            <li><strong>Party Pass (Â£2.99):</strong> One-time unlock for one party (2-Hour Session)</li>
            <li><strong>Pro Monthly (Â£9.99):</strong> Unlimited use, up to 10 phones</li>
          </ul>
        </div>
        <div class="info-section">
          <h3>âš ï¸ Important Notes</h3>
          <ul>
            <li>This is a browser prototype for testing purposes</li>
            <li>Users are responsible for their music source</li>
            <li>Best experience with same Wi-Fi network</li>
            <li>Host can control chat permissions (Open/Emoji Only/Locked)</li>
          </ul>
        </div>
      </div>
      <button class="btn primary" id="btnCloseParentInfo">Close</button>
    </div>
  </div>

  <!-- DJ Messages Container (global overlay) -->
  <div id="djMessagesContainer"></div>

  <!-- Authentication Views -->
  <section class="card hidden" id="viewLogin">
    <div class="auth-container">
      <h2>ğŸ§ Log In to SyncSpeaker</h2>
      <p class="muted">Access your DJ profile and subscription</p>
      
      <form id="formLogin" class="auth-form">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" class="input-field" placeholder="your@email.com" required />
        </div>
        
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" class="input-field" placeholder="Enter password" required />
        </div>
        
        <div class="auth-error hidden" id="loginError"></div>
        
        <button type="submit" class="btn primary full-width">Log In</button>
      </form>
      
      <div class="auth-links">
        <a href="#" id="linkForgotPassword">Forgot password?</a>
        <span>Â·</span>
        <a href="#" id="linkToSignup">Create account</a>
        <span>Â·</span>
        <a href="#" id="linkToLanding">Back</a>
      </div>
    </div>
  </section>

  <section class="card hidden" id="viewSignup">
    <div class="auth-container">
      <h2>ğŸµ Create Account</h2>
      <p class="muted">Join SyncSpeaker and start your DJ journey</p>
      
      <form id="formSignup" class="auth-form">
        <div class="form-group">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" class="input-field" placeholder="your@email.com" required />
        </div>
        
        <div class="form-group">
          <label for="signupPassword">Password</label>
          <input type="password" id="signupPassword" class="input-field" placeholder="At least 6 characters" required />
        </div>
        
        <div class="form-group">
          <label for="signupDjName">DJ Name (Optional)</label>
          <input type="text" id="signupDjName" class="input-field" placeholder="DJ Awesome" maxlength="30" />
        </div>
        
        <div class="auth-error hidden" id="signupError"></div>
        
        <button type="submit" class="btn primary full-width">Create Account</button>
      </form>
      
      <div class="auth-links">
        <a href="#" id="linkToLogin">Already have an account?</a>
        <span>Â·</span>
        <a href="#" id="linkSignupToLanding">Back</a>
      </div>
    </div>
  </section>

  <section class="card hidden" id="viewPasswordReset">
    <div class="auth-container">
      <h2>ğŸ”‘ Reset Password</h2>
      <p class="muted">Enter your email to receive a reset code</p>
      
      <form id="formPasswordResetRequest" class="auth-form">
        <div class="form-group">
          <label for="resetEmail">Email</label>
          <input type="email" id="resetEmail" class="input-field" placeholder="your@email.com" required />
        </div>
        
        <div class="auth-error hidden" id="resetRequestError"></div>
        <div class="auth-success hidden" id="resetRequestSuccess"></div>
        
        <button type="submit" class="btn primary full-width">Send Reset Code</button>
      </form>
      
      <form id="formPasswordReset" class="auth-form hidden">
        <div class="form-group">
          <label for="resetCode">Reset Code</label>
          <input type="text" id="resetCode" class="input-field" placeholder="Enter 6-character code" maxlength="6" required />
        </div>
        
        <div class="form-group">
          <label for="resetNewPassword">New Password</label>
          <input type="password" id="resetNewPassword" class="input-field" placeholder="At least 6 characters" required />
        </div>
        
        <div class="auth-error hidden" id="resetError"></div>
        
        <button type="submit" class="btn primary full-width">Reset Password</button>
      </form>
      
      <div class="auth-links">
        <a href="#" id="linkResetToLogin">Back to Login</a>
      </div>
    </div>
  </section>

  <!-- User Profile View -->
  <section class="card hidden" id="viewProfile">
    <div class="profile-container">
      <div class="row space">
        <h2>ğŸ‘¤ My Profile</h2>
        <button class="btn" id="btnCloseProfile">Back</button>
      </div>
      
      <div class="glass-card">
        <div class="profile-header">
          <div class="profile-avatar" id="profileAvatar">ğŸ§</div>
          <div class="profile-info">
            <h3 id="profileDjName">DJ Name</h3>
            <div class="profile-email" id="profileEmail">email@example.com</div>
            <div class="tier-badge" id="profileTierBadge">FREE</div>
          </div>
        </div>
      </div>
      
      <div class="glass-card">
        <h3>ğŸ“Š Stats</h3>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" id="statTotalParties">0</div>
            <div class="stat-label">Parties Hosted</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="statTotalTracks">0</div>
            <div class="stat-label">Tracks Played</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="statTotalGuests">0</div>
            <div class="stat-label">Total Guests</div>
          </div>
        </div>
      </div>
      
      <div class="glass-card" id="djRankSection">
        <h3>ğŸ† DJ Rank</h3>
        <div class="rank-display">
          <div class="rank-badge" id="profileRankBadge">BEGINNER</div>
          <div class="rank-score">
            <span id="profileScore">0</span> points
          </div>
        </div>
        <div class="rank-progress">
          <div class="rank-progress-bar">
            <div class="rank-progress-fill" id="profileRankProgress"></div>
          </div>
          <div class="rank-progress-label" id="profileRankLabel">Keep hosting to rank up!</div>
        </div>
      </div>
      
      <div class="glass-card">
        <h3>âš™ï¸ Settings</h3>
        <form id="formProfileUpdate">
          <div class="form-group">
            <label for="profileDjNameInput">DJ Name</label>
            <input type="text" id="profileDjNameInput" class="input-field" maxlength="30" />
          </div>
          
          <div class="form-group">
            <label for="profileGuestNameInput">Guest Name (for when you join parties)</label>
            <input type="text" id="profileGuestNameInput" class="input-field" maxlength="30" />
          </div>
          
          <button type="submit" class="btn primary">Save Changes</button>
        </form>
      </div>
      
      <div class="glass-card">
        <button class="btn danger full-width" id="btnLogout">Log Out</button>
      </div>
    </div>
  </section>

  <!-- ========================================================================
       MONETIZATION SCREENS
       ======================================================================== -->

  <!-- SCREEN 1: Main Upgrade Hub -->
  <section class="card hidden" id="viewUpgradeHub">
    <div class="monetization-container">
      <div class="row space">
        <h1>ğŸ‰ Level Up Your Party</h1>
        <button class="btn" id="btnCloseUpgradeHub">Back</button>
      </div>

      <!-- A: Current Status Card -->
      <div class="glass-card current-status-card">
        <div id="currentStatusFree" class="hidden">
          <h3>Your Current Plan: FREE</h3>
          <ul class="tier-features">
            <li>âœ“ 2 phones max</li>
            <li>âœ“ Emoji reactions only</li>
            <li>âœ“ Basic visuals</li>
            <li>âœ“ Unlimited time</li>
          </ul>
        </div>
        <div id="currentStatusPro" class="hidden">
          <h3>ğŸŒŸ You are PRO â€“ All features unlocked</h3>
          <p>Enjoy unlimited access to all features!</p>
        </div>
      </div>

      <!-- B: Primary Upgrade Cards -->
      <div class="upgrade-cards-grid">
        <!-- CARD 1: PRO Subscription -->
        <div class="upgrade-card pro-card">
          <div class="upgrade-badge pro">PRO MODE</div>
          <h2>Â£9.99 / month</h2>
          <p class="upgrade-tagline">Go all out with unlimited everything</p>
          <ul class="tier-features">
            <li>âœ“ Up to 10 phones</li>
            <li>âœ“ Custom messages</li>
            <li>âœ“ Pro visuals</li>
            <li>âœ“ No ads</li>
          </ul>
          <button class="btn btn-pro" id="btnPurchaseProSub">Go Pro Now</button>
        </div>

        <!-- CARD 2: Party Pass -->
        <div class="upgrade-card party-pass-card">
          <div class="popular-badge">Most popular</div>
          <div class="upgrade-badge party-pass">PARTY PASS</div>
          <h2>Â£2.99 (2 hours)</h2>
          <p class="upgrade-tagline">Perfect for tonight's party</p>
          <ul class="tier-features">
            <li>âœ“ Up to 4 phones</li>
            <li>âœ“ No ads</li>
            <li>âœ“ Pro features</li>
          </ul>
          <button class="btn btn-party-pass" id="btnPurchasePartyPass">Activate Party Pass</button>
        </div>

        <!-- CARD 3: Free Mode -->
        <div class="upgrade-card free-card">
          <div class="upgrade-badge free">FREE</div>
          <h2>Free â€“ Unlimited Time â€“ 2 Phones</h2>
          <p class="upgrade-tagline">Keep it simple and free</p>
          <button class="btn" id="btnContinueFree">Continue Free</button>
        </div>
      </div>

      <!-- C: Add-Ons Store Grid -->
      <div class="glass-card">
        <h3>ğŸ›ï¸ Add-Ons Store</h3>
        <div class="addons-grid">
          <button class="addon-btn" id="btnOpenVisualPacks">
            <div class="addon-icon">ğŸ¨</div>
            <div class="addon-name">Visual Packs</div>
          </button>
          <button class="addon-btn" id="btnOpenProfileUpgrades">
            <div class="addon-icon">âœ¨</div>
            <div class="addon-name">Profile Upgrades</div>
          </button>
          <button class="addon-btn" id="btnOpenDjTitles">
            <div class="addon-icon">ğŸ§</div>
            <div class="addon-name">DJ Titles</div>
          </button>
          <button class="addon-btn" id="btnOpenPartyExtensions">
            <div class="addon-icon">âš¡</div>
            <div class="addon-name">Party Extensions</div>
          </button>
          <button class="addon-btn" id="btnOpenHypeEffects">
            <div class="addon-icon">ğŸ”¥</div>
            <div class="addon-name">Hype Effects</div>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- SCREEN 2: Visual Pack Store -->
  <section class="card hidden" id="viewVisualPackStore">
    <div class="monetization-container">
      <div class="row space">
        <h1>ğŸ¨ Visual Packs</h1>
        <button class="btn" id="btnCloseVisualPacks">Back</button>
      </div>

      <div class="store-grid">
        <!-- Neon Lights Pack -->
        <div class="store-item" data-pack-id="neon-lights">
          <div class="store-preview" style="background: linear-gradient(135deg, #5AA9FF, #8B7CFF);">
            <div class="preview-animation neon-pulse"></div>
          </div>
          <h3>Neon Lights</h3>
          <p class="store-price">Â£3.99</p>
          <p class="store-description">Vibrant neon light show</p>
          <button class="btn primary btn-buy-pack" data-pack-id="neon-lights">BUY</button>
          <button class="btn btn-activate-pack hidden" data-pack-id="neon-lights">Set Active</button>
        </div>

        <!-- Festival Stage Pack -->
        <div class="store-item" data-pack-id="festival-stage">
          <div class="store-preview" style="background: linear-gradient(135deg, #8B7CFF, #FF6B9D);">
            <div class="preview-animation festival-pulse"></div>
          </div>
          <h3>Festival Stage</h3>
          <p class="store-price">Â£4.99</p>
          <p class="store-description">Epic festival vibes</p>
          <button class="btn primary btn-buy-pack" data-pack-id="festival-stage">BUY</button>
          <button class="btn btn-activate-pack hidden" data-pack-id="festival-stage">Set Active</button>
        </div>

        <!-- Club Pulse Pack -->
        <div class="store-item" data-pack-id="club-pulse">
          <div class="store-preview" style="background: linear-gradient(135deg, #FF6B9D, #5AA9FF);">
            <div class="preview-animation club-pulse"></div>
          </div>
          <h3>Club Pulse</h3>
          <p class="store-price">Â£2.99</p>
          <p class="store-description">Underground club energy</p>
          <button class="btn primary btn-buy-pack" data-pack-id="club-pulse">BUY</button>
          <button class="btn btn-activate-pack hidden" data-pack-id="club-pulse">Set Active</button>
        </div>
      </div>
    </div>
  </section>

  <!-- SCREEN 3: Profile Upgrades Store -->
  <section class="card hidden" id="viewProfileUpgrades">
    <div class="monetization-container">
      <div class="row space">
        <h1>âœ¨ Profile Upgrades</h1>
        <button class="btn" id="btnCloseProfileUpgrades">Back</button>
      </div>

      <p class="muted">All purchased upgrades stack and display together!</p>

      <div class="store-grid">
        <!-- Verified DJ Badge -->
        <div class="store-item" data-upgrade-id="verified-badge">
          <div class="store-icon">âœ“</div>
          <h3>Verified DJ Badge</h3>
          <p class="store-price">Â£1.99</p>
          <p class="store-description">Show you're legit</p>
          <button class="btn primary btn-buy-upgrade" data-upgrade-id="verified-badge">BUY</button>
          <div class="owned-badge hidden">OWNED</div>
        </div>

        <!-- Crown Effect -->
        <div class="store-item" data-upgrade-id="crown-effect">
          <div class="store-icon">ğŸ‘‘</div>
          <h3>Crown Effect</h3>
          <p class="store-price">Â£2.99</p>
          <p class="store-description">Royalty vibes</p>
          <button class="btn primary btn-buy-upgrade" data-upgrade-id="crown-effect">BUY</button>
          <div class="owned-badge hidden">OWNED</div>
        </div>

        <!-- Animated Name -->
        <div class="store-item" data-upgrade-id="animated-name">
          <div class="store-icon">âœ¨</div>
          <h3>Animated Name</h3>
          <p class="store-price">Â£2.49</p>
          <p class="store-description">Make your name pop</p>
          <button class="btn primary btn-buy-upgrade" data-upgrade-id="animated-name">BUY</button>
          <div class="owned-badge hidden">OWNED</div>
        </div>

        <!-- Reaction Trail -->
        <div class="store-item" data-upgrade-id="reaction-trail">
          <div class="store-icon">ğŸŒŸ</div>
          <h3>Reaction Trail</h3>
          <p class="store-price">Â£1.99</p>
          <p class="store-description">Leave your mark</p>
          <button class="btn primary btn-buy-upgrade" data-upgrade-id="reaction-trail">BUY</button>
          <div class="owned-badge hidden">OWNED</div>
        </div>
      </div>
    </div>
  </section>

  <!-- SCREEN 4: Party Extensions Store -->
  <section class="card hidden" id="viewPartyExtensions">
    <div class="monetization-container">
      <div class="row space">
        <h1>âš¡ Party Extensions</h1>
        <button class="btn" id="btnClosePartyExtensions">Back</button>
      </div>

      <p class="muted">Extensions apply instantly to your current party session!</p>

      <div class="store-grid">
        <!-- Add 30 Minutes -->
        <div class="store-item">
          <div class="store-icon">â°</div>
          <h3>Add 30 Minutes</h3>
          <p class="store-price">Â£0.99</p>
          <p class="store-description">Keep the party going</p>
          <button class="btn primary btn-buy-extension" data-extension-id="time-30">Add Time</button>
        </div>

        <!-- Add 5 More Phones -->
        <div class="store-item">
          <div class="store-icon">ğŸ“±</div>
          <h3>Add 5 More Phones</h3>
          <p class="store-price">Â£1.49</p>
          <p class="store-description">Bring more friends</p>
          <button class="btn primary btn-buy-extension" data-extension-id="phones-5">Add Phones</button>
        </div>
      </div>
    </div>
  </section>

  <!-- SCREEN 5: DJ Title Store -->
  <section class="card hidden" id="viewDjTitleStore">
    <div class="monetization-container">
      <div class="row space">
        <h1>ğŸ§ DJ Title Store</h1>
        <button class="btn" id="btnCloseDjTitles">Back</button>
      </div>

      <p class="muted">Only one title can be active at a time. Switch anytime!</p>

      <div class="store-grid">
        <!-- Rising DJ -->
        <div class="store-item" data-title-id="rising-dj">
          <div class="title-display">Rising DJ</div>
          <p class="store-price">Â£0.99</p>
          <p class="store-description">Starting your journey</p>
          <button class="btn primary btn-buy-title" data-title-id="rising-dj">BUY</button>
          <button class="btn btn-activate-title hidden" data-title-id="rising-dj">Activate</button>
        </div>

        <!-- Club DJ -->
        <div class="store-item" data-title-id="club-dj">
          <div class="title-display">Club DJ</div>
          <p class="store-price">Â£1.49</p>
          <p class="store-description">Making moves</p>
          <button class="btn primary btn-buy-title" data-title-id="club-dj">BUY</button>
          <button class="btn btn-activate-title hidden" data-title-id="club-dj">Activate</button>
        </div>

        <!-- Superstar DJ -->
        <div class="store-item" data-title-id="superstar-dj">
          <div class="title-display">Superstar DJ</div>
          <p class="store-price">Â£2.49</p>
          <p class="store-description">On top of the scene</p>
          <button class="btn primary btn-buy-title" data-title-id="superstar-dj">BUY</button>
          <button class="btn btn-activate-title hidden" data-title-id="superstar-dj">Activate</button>
        </div>

        <!-- Legend DJ -->
        <div class="store-item" data-title-id="legend-dj">
          <div class="title-display">Legend DJ</div>
          <p class="store-price">Â£3.49</p>
          <p class="store-description">Hall of fame status</p>
          <button class="btn primary btn-buy-title" data-title-id="legend-dj">BUY</button>
          <button class="btn btn-activate-title hidden" data-title-id="legend-dj">Activate</button>
        </div>
      </div>
    </div>
  </section>

  <!-- SCREEN 6: Checkout Flow -->
  <div class="modal hidden" id="modalCheckout">
    <div class="modal-content checkout-modal">
      <!-- Step 1: Confirmation -->
      <div class="checkout-step" id="checkoutConfirmation">
        <h2>Confirm Purchase</h2>
        <div class="checkout-item-preview" id="checkoutItemPreview">
          <!-- Filled dynamically -->
        </div>
        <div class="checkout-actions">
          <button class="btn primary" id="btnConfirmPurchase">Continue to Payment</button>
          <button class="btn" id="btnCancelCheckout">Cancel</button>
        </div>
      </div>

      <!-- Step 2: Payment Entry -->
      <div class="checkout-step hidden" id="checkoutPayment">
        <h2>Payment Details</h2>
        <p class="muted">This is a demo - no real payment is processed</p>
        <div class="form-group">
          <label>Card Number</label>
          <input type="text" class="input-field" placeholder="1234 5678 9012 3456" maxlength="19" />
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Expiry</label>
            <input type="text" class="input-field" placeholder="MM/YY" maxlength="5" />
          </div>
          <div class="form-group">
            <label>CVV</label>
            <input type="text" class="input-field" placeholder="123" maxlength="3" />
          </div>
        </div>
        <div class="checkout-actions">
          <button class="btn primary" id="btnProcessPayment">Process Payment</button>
          <button class="btn" id="btnBackToConfirm">Back</button>
        </div>
      </div>

      <!-- Step 3: Success Screen -->
      <div class="checkout-step hidden" id="checkoutSuccess">
        <div class="success-icon">âœ“</div>
        <h2>Upgrade Activated</h2>
        <p class="success-message">Ready to Use Now</p>
        <button class="btn primary" id="btnCloseCheckoutSuccess">Awesome!</button>
      </div>
    </div>
  </div>

  <!-- Upsell Modal (reusable for various upsell locations) -->
  <div class="modal hidden" id="modalUpsell">
    <div class="modal-content upsell-modal">
      <h2 id="upsellTitle">Unlock Feature</h2>
      <p id="upsellMessage">Upgrade to unlock this feature!</p>
      <div class="upsell-actions">
        <button class="btn primary" id="btnUpsellUpgrade">Upgrade Now</button>
        <button class="btn" id="btnUpsellClose">Maybe Later</button>
      </div>
    </div>
  </div>

  <script src="auth.js"></script>
  <script src="visual-stage.js"></script>
  <script src="moderation.js"></script>
  <script src="network-accessibility.js"></script>
  <script src="qr-deeplink.js"></script>
  <script src="app.js"></script>
</body>
</html>
